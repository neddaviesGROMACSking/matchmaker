
id_list = ['22650981', '21964509', '21963169', '21883221', '21840343', '21831360', '21791566', '21660499', '21605970', '21427642', '21386675', '21311009', '21295225', '21184165', '21169199', '21143788', '21068835', '21045058', '20691252', '20637909', '20553184', '20510925', '20418887', '20138074', '20060021', '20043895', '20033797', '20032969', '20012406', '20012404', '19958391', '19890232', '19874574', '19733230', '19666046', '19482061', '19477923', '19447090', '19304871', '19274630', '19219037', '19144855', '19096451', '19051237', '19009022', '18987003', '18946742', '18355967', '18255048', '17947996', '17947979', '17931433', '17919130', '17823922', '17822783', '17760997', '17713528', '17598886', '17523083', '17504244', '17346678', '17344885', '17301183', '17151600', '17130148', '16772024', '16618939', '16549500', '16342898', '16262207', '16257455', '16076629', '16046005', '15836895', '15817737', '15814150', '15770241', '15745951', '15710042', '15680265', '15518644', '15343197', '15276805', '15155579', '15018818', '12932834', '12702209', '12629581', '12582260', '12466847', '11891777', '11779477', '11604416', '11388358', '9751056', '9476986', '7979251', '7695038', '5639894', '3389639', '3291664', '3291663', '2930330', '1930606', '1773077', '1320764', '352224', '21806979', '21600200', '21148187', '20978236', '20929839', '20724449', '20643352', '20348033', '19782673', '19601975', '19557684', '19378259', '19235875', '19087265', '18308339', '17082421', '16408088', '16364368', '16098989', '15809037', '15691764', '12941592', '12919696', '12163415', '11830559', '11044393', '10559483', '10529418', '7496093', '1702679', '21889525', '21875653', '21683787', '21615264', '21522057', '21408171', '21352832', '21278812', '21122812', '21030954', '20813169', '20717121', '20705091', '20623473', '20600350', '20561961', '20523756', '20165943', '19997843', '19949253', '19643124', '19540270', '19455435', '19391150', '19322172', '19321151', '19275547', '19269047', '19264814', '19255630', '19183139', '19109716', '18930731', '18679658', '18652595', '18562421', '18423643', '18377224', '18248264', '18054804', '18037171', '17922234', '17761399', '17560636', '17521353', '17219220', '17196640', '17049956', '16305457', '15798779', '15451036', '15141183', '14007905', '13986968', '13309607', '12787858', '11224390', '11224312', '10596419', '9833015', '9754835', '9328021', '9301661', '8561958', '8485625', '7968937', '7871076', '7231047', '7199187', '7198271', '7198045', '7192165', '7167862', '7053409', '6890686', '6805009', '6700368', '6687096', '6581976', '6540902', '6538800', '6514253', '6513725', '6479216', '6109037', '5834759', '5499699', '5147592', '5104429', '4686103', '4541483', '4478022', '4330905', '4197635', '3967742', '3941597', '3747721', '3685068', '3086736', '2931287', '2923107', '2822907', '2596441', '2547936', '2163537', '2160793', '2147794', '1467389', '1434136', '1239785', '1182341', '1080571', '823287', '812935', '575093', '566933', '287665', '119274', '116288', '8055', '18371431', '15758976', '20477071', '20476905', '20004242', '19622861', '17481747', '16751154', '16548766', '16283677', '16178737', '15711537', '12897767', '11892935', '11774793', '11351775', '10998351', '10495353', '10377223', '9873686', '9827991', '9374491', '9224565', '9043657', '8968371', '8717520', '7997261', '7750577', '22328274', '21749961', '21570997', '21559304', '21545830', '21537944', '21383146', '21382508', '21357145', '21266970', '21262817', '21206538', '21205846', '21187119', '21145744', '21109663', '21108973', '20955750', '20935642', '20678210', '20674703', '20634040', '20626564', '20547142', '20540966', '20510300', '20436931', '20406487', '20359501', '20351718', '20134420', '20117146', '20107084', '20035794', '19896505', '19836422', '19646228', '19629023', '19617646', '19501674', '19497864', '19428651', '19410636', '19064351', '18836206', '18700055', '18616985', '18499199', '18463701', '18446160', '18391188', '18202183', '17991680', '17854920', '17707522', '17611082', '17553730', '17313829', '17306892', '17180878', '17098297', '16775081', '16741974', '16408248', '16182325', '16019606', '15820706', '15730879', '15723230', '15475332', '15238158', '15210172', '15186744', '14739700', '14739581', '14557605', '13665503', '12955228', '12930818', '12698231', '12600704', '12479969', '12405513', '12027951', '11827738', '11714494', '11693272', '11378177', '11166068', '11040348', '10974491', '10701871', '10599485', '10585639', '10560925', '10432492', '10073474', '9884114', '9695128', '9369362', '9135093', '8878071', '8866939', '8864686', '8815955', '8430127', '8373936', '7393955', '6812137', '4040468', '3843306', '2789700', '2287483', '2138338', '1745714', '1594107', '583014', '20420576', '20006651', '19956756', '19680634', '18973603', '18433738', '18262520', '17492136', '17297639', '17223101', '17105959', '16595612', '15228154', '15129777', '15099927', '14751419', '14517176', '13859079', '12220572', '12098589', '11599334', '10989266', '10426541', '10080230', '9952039', '8895996', '7945733', '2574478', '1731054', '20297743', '19633334', '19364998', '19244192', '19150898', '18649498', '17329314', '16776895', '16735613', '16356992', '16327113', '16327107', '15054016', '11419581', '10691060', '10560780', '10371363', '10326995', '8052273', '4014207', '3806354', '19538503', '19438415', '19282762', '19245372', '18940978', '18198184', '18090112', '17610795', '17606089', '17583379', '17513535', '17224203', '16946283', '16849988', '16801841', '16794102', '16766743', '16677976', '16515429', '16373794', '16203280', '15940089', '15682128', '15671967', '15632403', '15333534', '15333521', '15167190', '14709429', '14634610', '14609414', '12883504', '12683874', '12574009', '12548266', '11823772', '11679865', '11581086', '11223763', '10730830', '10406748', '9258798', '8970003', '8673783', '8604869', '17314132', '17079689', '16916602', '16892058', '16571631', '16449319', '16357871', '16314867', '16251968', '16094321', '16009138', '15935773', '15720724', '15694310', '15689379', '15657073', '15343271', '15324689', '15324659', '15196564', '15141162', '15084291', '14981097', '14685273', '14675534', '14657233', '14623439', '12874119', '12756224', '12736210', '12629547', '12530964', '12471246', '11832243', '11740941', '11591316', '11544035', '11433294', '11150237', '11117748', '11117747', '11060229', '10995441', '10878812', '10518489', '9259552', '8791533', '8521491', '7821229', '7626797', '7596407', '2555164', '2426572', '1811161', '1811156', '16433524', '16408022', '16365301', '16331995', '16239639', '16060671', '16045346', '16043710', '15914667', '15914666', '15699629', '15250723', '15250722', '15044472', '14992588', '14649819', '14645716', '14529284', '13947099', '12733873', '12656607', '12570851', '12195017', '12120414', '12050675', '11828436', '9469822', '8081740', '8063830', '3393228', '2023635', '12626701', '12574521', '12452685', '12384704', '12034817', '11990855', '11558999', '11438730', '11438689', '11406376', '11405224', '11320222', '11306347', '11243837', '11006537', '10966639', '10792044', '10788591', '10358100', '10097095', '9755862', '9671724', '9548937', '9485450', '9405376', '8692883', '8464916', '8422371', '7739037', '5233469']
id_list2 = ['31191266', '28544613', '27909802', '26675822', '26092690', '25374613', '25315739', '33905756', '33553276', '33420260', '32962160', '32752218', '31481885', '31413047', '30875831', '29784925', '29748917', '28984854', '28855876', '28071731', '27812327', '26845413', '26778786', '25729356', '25349164', '25257106', '24726051', '24412421', '24149185', '23883191', '23827499', '23590400', '31349617', '30635860', '30009933', '28804452', '26809583', '26397369', '25748653', '24290383', '23781172', '31218026', '27562614', '25388291', '25079766', '24740186', '34445171', '34368117', '34187479', '33510219', '33188831', '32631936', '32403340', '32246073', '32212430', '32202514', '32093039', '32009857', '31748696', '31404436', '31181856', '31174272', '31091804', '30070967', '29471431', '29091281', '29021890', '28217866', '27853566', '27328013', '27128096', '26348672', '26347614', '25523356', '25104936', '24336189', '24116082', '24015357', '23758125', '23342131', '33154503', '31921852', '31765425', '31662288', '31022843', '30760477', '29866044', '29615588', '29532549', '28213462', '27811357', '26769961', '26745863', '26589921', '26425560', '26273595', '25295121', '25047453', '24271780', '23421592', '29184888', '28223499', '28106753', '27582505', '34493721', '33979592', '33872193', '33483696', '33333067', '33033117', '32829689', '32666711', '32620834', '32511091', '32269502', '32143746', '32127348', '31811714', '31398237', '31072004', '30916254', '30819884', '30789897', '30730874', '30575724', '30481168', '30417097', '30235284', '30069009', '29896534', '29727442', '29725615', '29650003', '29615597', '29402913', '29261650', '29150667', '29079424', '28937677', '28870989', '28855385', '28817360', '28700594', '27196433', '27148743', '27058171', '26771020', '26755699', '26721501', '26689739', '26571046', '26562406', '26538639', '26332583', '26240329', '26077909', '25973920', '25795263', '25750229', '25695252', '25605783', '25605777', '25122550', '25026465', '24644145', '24550288', '24385915', '24173805', '23818579', '23546880', '23347888', '23325214', '23316168', '23131803', '22499809', '34344922', '34239694', '33598409', '30911792', '30302279', '28790193', '27396581', '27386877', '26841800', '24526841', '23922773', '24133417', '23869690', '23383380', '34537895', '33515278', '33086704', '32726939', '32585475', '30925821', '30534049', '29527169', '28994023', '28775328', '28596596', '28596539', '28282918', '28238851', '27895618', '27545681', '26319171', '26092527', '24291671', '24147021', '23349914', '22822044', '22736461', '22730455', '34354255', '34223157', '33881780', '33275615', '32751991', '32671184', '31936067', '31673920', '31378059', '30718771', '30696107', '29687023', '28166285', '28056771', '27680884', '27474091', '26401942', '24900510', '24393126', '23840427', '29552418', '28649464', '28584230', '24474647', '23970445', '34502414', '34348667', '34264421', '34253753', '34244814', '34079463', '33536881', '33520441', '33501086', '33501054', '33382700', '33203921', '33024947', '32786314', '32753576', '32635596', '32435716', '32433025', '32201650', '32174811', '31948542', '31772712', '31768573', '31614187', '31497403', '31410315', '31396063', '31373315', '31324839', '31144017', '30948475', '30842911', '30320245', '30251620', '29339520', '29308271', '29118373', '29072584', '28817785', '28512334', '28448016', '28229024', '27790739', '27186793', '27123163', '26862467', '26616910', '26487810', '26441567', '26045453', '26032017', '26028515', '25789546', '25741256', '25392396', '25326170', '25232132', '25004302', '24690524', '24679220', '24671398', '24575942', '23706039', '23691016', '23449968', '23383208', '22879998', '33729153', '30683682', '25561540', '24384067', '24066146', '23123364', '22951180', '34094353', '34055219', '34028272', '34027955', '33983732', '33847110', '33482713', '32734671', '32550999', '31846111', '31749903', '31649841', '31446758', '31426567', '31205412', '31057741', '30832206', '30613315', '30516383', '30140018', '29848279', '29637680', '29323664', '29249834', '28983993', '28579699', '27573303', '27562724', '27385089', '27334348', '27125384', '26358926', '26098485', '25750602', '25685311', '25288871', '25242481', '24900676', '24604837', '24498372', '24481311', '24204758', '24085536', '23800010', '23627990', '23422561', '23393259', '23185259', '22632792', '22543468', '22183577', '33101067', '32428631', '32214126', '31721416', '30846817', '29787611', '29449560', '29327202', '27933364', '27022258', '26898327', '26365406', '25527642', '25069822', '24807251', '24068193', '24058598', '22544551', '22251567', '33689951', '27318987', '21843537', '32785052', '25814788', '23880765', '31238822', '28222093', '28095623', '25267293', '24662486', '24165937', '23987511', '23571210', '22406140', '33747652', '33547520', '32670102', '30788408', '30347286', '29406769', '28824953', '28597246', '24837584', '24615355', '24503925', '23702103', '23639764', '23488496', '22959075', '22935623', '21915745', '33556714', '31712801', '30057657', '26942042', '26618409', '24604125', '23159323', '26026391', '25079768', '34123011', '33041806', '32874643', '31129879', '30362380', '28179579', '25760829', '24764867', '22888461', '34369969', '34027344', '33644777', '33247025', '33159461', '32963825', '32497914', '32105411', '31957530', '31831635', '31498823', '31210766', '31146701', '31041869', '30591767', '30318376', '29849369', '29101290', '29066448', '28928186', '28412954', '28232323', '28197284', '27468142', '26861658', '26796023', '26695366', '26549506', '26445548', '26283602', '25971820', '25889753', '25639761', '25492251', '25488040', '24980680', '24772523', '24550530', '24522799', '24413349', '24352519', '23696582', '23559909', '23263917', '23239837', '22996571', '22576845', '22484515', '22179539', '22137070', '22123793', '21859971', '21403074', '21245461', '21160056', '20698898', '33620645', '32643366', '32498019', '31935908', '31925410', '31482470', '31311868', '31266368', '31200510', '30190843', '30109180', '29732117', '29641457', '29063678', '28740606', '28647489', '28625132', '28571593', '28436422', '28351980', '27760319', '26858988', '26673799', '26351322', '25971798', '25742792', '25738359', '25435214', '25350931', '25320010', '25195011', '25130256', '25101824', '25053989', '24771846', '24476679', '24185007', '23548044', '23530568', '23288408', '23085539', '22986633', '22961667', '22589389', '21291394', '21110380', '33050829', '31564024', '34344300', '34292458', '33832104', '33731096', '33558353', '33116958', '33045030', '33012378', '33000054', '32793754', '32610791', '32538350', '32434475', '32377860', '31934386', '31888609', '31747917', '31172126', '30770207', '30540856', '30534009', '30048262', '29802522', '29719423', '29450701', '29177177', '28461348', '28413420', '28409028', '28121876', '27331174', '27171476', '26553523', '26362293', '25738132', '25569321', '25493116', '25483493', '25215071', '24954578', '24940347', '24829802', '24421704', '23813265', '23759699', '23304348', '22875541', '21771339', '31580797', '31533128', '27890388', '27865650', '27793574', '27760725', '27751693', '27726980', '26702880', '26642226', '26462913', '33123537', '29651942', '25078151', '24072592', '23982212', '33430461', '24900437', '24519385', '23936194', '21780805', '21467839', '21187426', '20145274', '32954123', '32637042', '30996798', '25893042', '25393557', '25364231', '24332487', '22798776', '21185177', '20923157', '26732194', '25653049', '19224342', '21400308', '33407086', '32336092', '26559061', '26148533', '24414205', '23435857', '34358319', '33869654', '33559689', '33365313', '32831364', '32194342', '31739541', '31632122', '31183862', '30740687', '30206237', '29967585', '29615581', '29569827', '29449653', '29298840', '28869686', '28508727', '28408465', '28188103', '28108485', '28005067', '27836834', '27713415', '27638855', '27633996', '27583644', '27486814', '27400796', '27388244', '27376691', '27210748', '26725110', '26686687', '26477526', '26458176', '26365900', '26221261', '26174486', '25914765', '25754204', '24894772', '24850855', '24553180', '24412757', '24324557', '24298330', '24052942', '23754954', '23717633', '23708646', '23675967', '23661712', '23618830', '23370908', '23326522', '23271740', '23236128', '23202735', '23001988', '22901255', '22898598', '22802352', '22761764', '22640993', '22586074', '22556407', '22457346', '22343916', '22036566', '21666599', '21466798', '21325129', '21212834', '21148566', '21087926', '20828405', '20805504', '20681018', '20644535', '20494928', '20439491', '20089964', '20029447', '19910091', '19796250', '19703992', '19440194', '19365640', '19358838', '19352317', '19287487', '19265664', '18462699', '18252864', '31911891', '30814118', '30410020', '30256191', '28095645', '27185860', '26446842', '25848696', '24994932', '24681784', '24282618', '23994638', '23132247', '22778024', '22658936', '22110058', '21490805', '20733003', '19789178', '19782678', '19686683', '19633170', '19013452', '32666052', '30979871', '28348255', '23876427', '22193956', '21289065', '20887895', '20717145', '19752024', '19603030', '18996154', '18824165', '18583124', '18343171', '34406854', '31671605', '31270411', '30987350', '30905967', '30463908', '27723854', '26516701', '26372962', '25695333', '25519881', '25425646', '25408244', '24845061', '23624850', '22546478', '22084399', '22069029', '20657448', '19852504', '19689374', '19261605', '19105050', '18663490', '30658587', '17954698', '30239898', '29997820', '23700306', '22487183', '20725626', '20348136', '19685880', '19261597', '19112078', '18567908', '18295608', '17395639', '34299191', '33547419', '32716297', '31090542', '30063005', '29771303', '29559363', '29426949', '27714636', '26872368', '26293695', '26101582', '25907283', '25043181', '24993822', '24259665', '23720287', '23326681', '23066429', '22576663', '22553378', '22169974', '21963539', '21285348', '20066082', '19888962', '19629071', '19623618', '19279717', '19234454', '18976916', '18710302', '18367611', '18312645', '18045904', '17993468', '17981131', '17476309', '17433285', '17426148', '17372192', '16790480', '16707567', '34040637', '33456719', '33304906', '33217978', '33111190', '32733053', '32581710', '32165725', '30525123', '30364989', '30127218', '30002130', '29712790', '29316653', '29033484', '26900852', '26896748', '25574849', '25232532', '25131541', '24896083', '24584103', '24307374', '24135485', '24126255', '23861630', '23837677', '23758163', '23382971', '23184530', '23166393', '22711424', '22327645', '22178644', '21874153', '21864354', '21767634', '21671358', '21652627', '21411522', '20961400', '20737414', '20518610', '20457659', '20378823', '20169042', '19918803', '19564914', '19386991', '18627530', '18261230', '32559447', '29615614', '29440382', '29023694', '25371360', '24718453', '22130222', '21635789', '21266466', '20353597', '17497687', '26146646', '24913037', '23023215', '21949350', '20362089', '16988010', '34540899', '33925350', '33918184', '33469659', '32823549', '32791468', '32690897', '31972988', '31892146', '31754698', '30944218', '30871220', '30802054', '30305390', '30210793', '29163897', '29069417', '28977514', '28375735', '28369584', '28150040', '27883140', '27854257', '27799468', '27270004', '26615192', '26329134', '26245347', '26202965', '25897130', '25589786', '25245945', '25013179', '24920827', '24885782', '24843019', '24808992', '24516170', '24487181', '24367594', '23999095', '23804761', '23771141', '23326389', '23303789', '23193257', '22727781', '22404684', '21941250', '21744844', '21416200', '21302011', '20409481', '20213319', '20107659', '19951355', '19717545', '19705869', '19692585', '19603437', '19359361', '19271707', '19198658', '19081949', '18817431', '18718931', '18599514', '18563930', '18536803', '18535007', '18373984', '18338058', '18174225', '18092816', '18047349', '17913750', '17910454', '17895279', '17641956', '17626043', '17523641', '17519204', '17395643', '17200301', '17169996', '17109036', '17040983', '17040899', '17012276', '16866556', '16866537', '16714449', '16714104', '16365301', '16321964', '16106044', '15933211', '15914666', '15591017', '15475390', '15452356', '15115800', '25346867', '18039714', '17075132', '33425731', '32647375', '30092773', '29967064', '29022902', '28289208', '27480082', '26440826', '26413869', '25069613', '24793789', '24367100', '24022664', '23073828', '22131966', '22020250', '21911744', '21557502', '21551070', '21549744', '21272562', '21191700', '20648061', '19400726', '18794113', '18787224', '18701453', '18381407', '18308762', '17959818', '17404884', '16966378', '16510873', '16438732', '16407837', '16396636', '16189157', '15972957', '15731909', '15623475', '14976552', '28261431', '25721123', '18949526', '34158676', '33831389', '33320908', '31840104', '31054969', '30948723', '30251853', '30090237', '30059210', '29675147', '29604810', '29300447', '28717574', '28436469', '28255174', '26818700', '25646430', '24729836', '23685210', '23677392', '23351712', '23267181', '23239594', '22382526', '22179788', '22078542', '22057212', '20877860', '19835419', '19628690', '19350088', '18796612', '18515376', '18361491', '18305159', '17971442', '17653837', '17513380', '17299036', '17279362', '16608333', '16517937', '15175430', '14747337', '14602909', '30979116', '26495243', '25035838', '20191000', '32723475', '30257865', '26950608', '25510493', '24633353', '23868291', '23275549', '23184978', '21912726', '21717030', '21586581', '20457603', '19947597', '19820116', '19282454', '16973897', '16460021', '16085756', '15642696', '14653736', '14645716', '15343271', '14740210', '27101364', '25646408', '24830352', '23152446', '23150675', '22583698', '21833375', '21613981', '21045819', '20880495', '20843859', '20699656', '20066104', '19618466', '19605501', '18706811', '18364710', '18091725', '17925879', '17925852', '17673236', '17438000', '17428460', '17150209', '17047664', '15517134']

d = {
    'tag': 'and',
    'fields_': [
        {
            'tag': 'author',
            'operator': {
                'tag': 'equal',
                'value': 'Jeremy Green'
            }
        },
        {
            'tag': 'year',
            'operator': {
                'tag': 'range',
                'lower_bound': '2001',
                'upper_bound': '2012'
            }
        }
    ]
}


from httpx import AsyncClient, Limits
from matchmaker.query_engine.backends.pubmed_api import efetch_on_id_list, esearch_on_query, PubmedEFetchQuery, PubmedESearchQuery
import asyncio
async def main():
    async def make_coroutine(client_in):
        query = PubmedEFetchQuery(pubmed_id_list= id_list)
        search_query = PubmedESearchQuery.parse_obj(d)
        # Note: Use futures to pass attributes then use gather
        search = esearch_on_query(search_query, client_in)
        results = efetch_on_id_list(query, client_in)

        query2 = PubmedEFetchQuery(pubmed_id_list= id_list2)
        results2 = efetch_on_id_list(query2, client_in)
        searcher, results, results2 = await asyncio.gather(search, results, results2)
        return results
    # Run native query
    async with AsyncClient(timeout=None) as client:

        await make_coroutine(client)
    
    #return results
results = asyncio.run(main())
print(len(str(results)))